---
const { showLogin = true } = Astro.props;
const formId = showLogin ? 'loginForm' : 'registerForm';
---

<div class="modal fade" id="authModal" tabindex="-1" aria-labelledby="authModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header border-0">
        <h5 class="modal-title fw-bold" id="authModalLabel">
          {showLogin ? 'üîê Login to Book' : 'üë§ Create Account'}
        </h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      
      <form id={formId} class="needs-validation" novalidate>
        <div class="modal-body">
          <!-- EMAIL FIELD (BOTH forms) -->
          <div class="mb-3">
            <label for="authEmail" class="form-label fw-semibold">Email Address</label>
            <input 
              type="email" 
              class="form-control" 
              id="authEmail" 
              name="email"
              placeholder="user@example.com"
              required 
            />
            <div class="invalid-feedback">Please enter a valid email address.</div>
          </div>

          <!-- PASSWORD FIELD (Login + Register) -->
          <div class="mb-3">
            <label for="authPassword" class="form-label fw-semibold">Password</label>
            <input 
              type="password" 
              class="form-control" 
              id="authPassword" 
              name="password"
              placeholder="At least 6 characters"
              minlength="6"
              required 
            />
            <div class="invalid-feedback">Password must be at least 6 characters.</div>
          </div>

          <!-- REGISTER ONLY: Confirm Password -->
          {!showLogin && (
            <div class="mb-3">
              <label for="confirmPassword" class="form-label fw-semibold">Confirm Password</label>
              <input 
                type="password" 
                class="form-control" 
                id="confirmPassword" 
                name="confirmPassword"
                placeholder="Repeat your password"
                required 
              />
              <div class="invalid-feedback">Passwords do not match.</div>
            </div>
          )}
        </div>

        <div class="modal-footer border-0">
          <!-- Submit Button -->
          <button type="submit" class="btn btn-danger w-100 fw-bold">
            {showLogin ? 'Login' : 'Create Account'}
          </button>
          
          <!-- Toggle Link -->
          {showLogin ? (
            <div class="text-center mt-3">
              <small class="text-muted">Don't have an account? </small>
              <button type="button" class="btn btn-link p-0 text-decoration-none" id="switchToRegister">
                Create one here
              </button>
            </div>
          ) : (
            <div class="text-center mt-3">
              <small class="text-muted">Already have an account? </small>
              <button type="button" class="btn btn-link p-0 text-decoration-none" id="switchToLogin">
                Login here
              </button>
            </div>
          )}
        </div>
      </form>
    </div>
  </div>
</div>
