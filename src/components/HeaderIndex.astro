---
const site_base = import.meta.env.VITE_SITE_BASE;

const { currentPage, showcaseTitle } = Astro.props;
const navItems = [
  { href: `${site_base}`, label: "Home", icon: "fa-house", id: "index" },
  { href: `${site_base}suites`, label: "Suites", icon: "fa-bed", id: "suites" },
  {
    href: `${site_base}dining`,
    label: "Dining",
    icon: "fa-utensils",
    id: "dining",
  },
  {
    href: `${site_base}experience`,
    label: "Experience",
    icon: "fa-spa",
    id: "experience",
  },
  {
    href: `${site_base}access`,
    label: "Access",
    icon: "fa-universal-access",
    id: "access",
  },
];
---

<header class="header index-header">
  <nav class="navbar navbar-expand-lg custom-glass-navbar">
    <div class="container navbar__container">
      <a
        href={site_base}
        class="navbar__logo-link"
        aria-label="Skye Suites Home"
      >
        <img
          src={`${site_base}assets/logo.png`}
          alt="Skye Suites Logo"
          class="navbar__logo"
          loading="lazy"
        />
      </a>

      <!-- Hamburger toggle -->
      <button
        class="navbar-toggler"
        type="button"
        data-bs-toggle="offcanvas"
        data-bs-target="#offcanvasNav"
        aria-controls="offcanvasNav"
        aria-label="Toggle navigation"
      >
        <span class="navbar-toggler-icon"></span>
      </button>

      <!-- Large screen desktop nav -->
      <div class="collapse navbar-collapse d-none d-lg-flex" id="navbarSupportedContent">
        <ul class="navbar-nav ms-auto mb-2 mb-lg-0" role="menubar" aria-label="Main Menu">
          {
            navItems.map(({ href, label, icon, id }) => (
              <li class="nav-item">
                <a
                  href={href}
                  class={`nav-link${currentPage === id ? " active" : ""}`}
                  aria-current={currentPage === id ? "page" : undefined}
                >
                  <i class={`fa-solid ${icon}`} aria-hidden="true" /> {label}
                </a>
              </li>
            ))
          }
        </ul>

        <!-- User Profile Dropdown (logged in) -->
        <div id="userProfileNav" class="d-none ms-lg-2">
          <div class="dropdown">
            <button 
              class="btn btn-outline-light dropdown-toggle btn-sm" 
              type="button" 
              data-bs-toggle="dropdown" 
              aria-expanded="false"
            >
              <i class="fa-solid fa-user-circle me-1"></i>
              <span id="userEmailNav" class="d-none d-md-inline">User</span>
            </button>
            <ul class="dropdown-menu dropdown-menu-end">
              <li><a class="dropdown-item" href={`${site_base}profile`}>
                <i class="fa-solid fa-calendar-check me-2"></i>My Bookings
              </a></li>
              <li><a class="dropdown-item" href={`${site_base}profile#account`}>
                <i class="fa-solid fa-user me-2"></i>User Profile
              </a></li>
              <li><hr class="dropdown-divider"></li>
              <li>
                <button class="dropdown-item text-danger w-100 text-start" id="logoutBtn">
                  <i class="fa-solid fa-sign-out-alt me-2"></i>Logout
                </button>
              </li>
            </ul>
          </div>
        </div>

        <!-- Login Button (logged out) -->
        <div id="loginNav" class="ms-lg-2">
          <button 
            class="btn btn-danger navbar__book-button"
            data-bs-toggle="modal" 
            data-bs-target="#authModal"
            id="loginTrigger"
            title="Login to book rooms"
          >
            <i class="fa-solid fa-user"></i> <span class="d-none d-md-inline">Login</span>
          </button>
        </div>
      </div>
    </div>
  </nav>

  <!-- Mobile Offcanvas -->
  <div class="offcanvas offcanvas-start" tabindex="-1" id="offcanvasNav" aria-labelledby="offcanvasNavLabel">
    <div class="offcanvas-header">
      <h5 class="offcanvas-title" id="offcanvasNavLabel">Menu</h5>
      <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Close"></button>
    </div>
    <div class="offcanvas-body custom-vertical-center">
      <ul class="navbar-nav flex-column" role="menubar" aria-label="Main Menu">
        {
          navItems.map(({ href, label, icon, id }) => (
            <li class="nav-item mb-2">
              <a
                href={href}
                class={`nav-link${currentPage === id ? " active" : ""} py-2`}
                aria-current={currentPage === id ? "page" : undefined}
              >
                <i class={`fa-solid ${icon} me-2`} aria-hidden="true" /> {label}
              </a>
            </li>
          ))
        }
      </ul>

      <!-- Mobile Auth Section -->
      <div id="offcanvasUserProfile" class="d-none mt-4 pt-3 border-top">
        <div class="mb-3">
          <small class="d-block text-white-50 mb-2" id="offcanvasUserEmail">User</small>
        </div>
        <a href={`${site_base}profile`} class="btn btn-outline-light btn-sm w-100 mb-2">
          <i class="fa-solid fa-calendar-check me-2"></i>My Bookings
        </a>
        <a href={`${site_base}profile#account`} class="btn btn-outline-light btn-sm w-100 mb-2">
          <i class="fa-solid fa-user me-2"></i>User Profile
        </a>
        <button class="btn btn-outline-light btn-sm w-100" id="offcanvasLogoutBtn">
          <i class="fa-solid fa-sign-out-alt me-2"></i>Logout
        </button>
      </div>

      <div id="offcanvasLoginNav" class="mt-4 pt-3 border-top">
        <button class="btn btn-danger w-100" data-bs-toggle="modal" data-bs-target="#authModal">
          <i class="fa-solid fa-user me-2"></i>Login to Book
        </button>
      </div>
    </div>
  </div>

  <!-- Hero Slideshow (Index only) -->
  <div class="hero-slideshow">
    <div class="slide slide1"></div>
    <div class="slide slide2"></div>
    <div class="slide slide3"></div>
    <div class="slide slide4"></div>
    <div class="slide slide5"></div>
    <div class="slide slide6"></div>
  </div>

  <!-- Showcase (Index only) -->
  <div class="showcase index--showcase">
    <h1 class="showcase__title">{showcaseTitle}</h1>
  </div>
</header>
